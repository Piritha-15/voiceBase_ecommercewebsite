{"ast":null,"code":"var _jsxFileName = \"D:\\\\PROJECT1\\\\frontend\\\\src\\\\context\\\\VoiceContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useState, useEffect } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst VoiceContext = /*#__PURE__*/createContext();\nexport const useVoice = () => {\n  _s();\n  const context = useContext(VoiceContext);\n  if (!context) {\n    throw new Error('useVoice must be used within a VoiceProvider');\n  }\n  return context;\n};\n_s(useVoice, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport const VoiceProvider = ({\n  children\n}) => {\n  _s2();\n  const [isListening, setIsListening] = useState(false);\n  const [recognition, setRecognition] = useState(null);\n  const [synthesis, setSynthesis] = useState(null);\n  const [offlineMode, setOfflineMode] = useState(false);\n  useEffect(() => {\n    console.log('Initializing Voice API...');\n\n    // Initialize Web Speech API\n    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {\n      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\n      const recognitionInstance = new SpeechRecognition();\n      recognitionInstance.continuous = false;\n      recognitionInstance.interimResults = false;\n      recognitionInstance.lang = 'en-US';\n      recognitionInstance.maxAlternatives = 1;\n\n      // Configure for better offline/network handling\n      try {\n        // Try to set service URI to local if available (Chrome specific)\n        if (recognitionInstance.serviceURI !== undefined) {\n          recognitionInstance.serviceURI = '';\n        }\n      } catch (e) {\n        console.log('Cannot configure offline mode, using default');\n      }\n      console.log('Speech Recognition initialized');\n      setRecognition(recognitionInstance);\n    } else {\n      console.error('Speech Recognition not supported in this browser');\n    }\n    if ('speechSynthesis' in window) {\n      console.log('Speech Synthesis initialized');\n      setSynthesis(window.speechSynthesis);\n\n      // Preload voices to avoid delays\n      if (window.speechSynthesis.getVoices().length === 0) {\n        window.speechSynthesis.addEventListener('voiceschanged', () => {\n          console.log('Voices loaded:', window.speechSynthesis.getVoices().length);\n        });\n      }\n    } else {\n      console.error('Speech Synthesis not supported in this browser');\n    }\n  }, []);\n  const startListening = (onResult, onError) => {\n    console.log('startListening called');\n    if (!recognition) {\n      console.error('Recognition not available');\n      onError && onError('Speech recognition not supported');\n      return;\n    }\n\n    // Stop any existing recognition first\n    try {\n      recognition.stop();\n    } catch (e) {\n      // Ignore errors when stopping\n    }\n    console.log('Setting up recognition handlers...');\n    setIsListening(true);\n\n    // Clear any existing handlers\n    recognition.onstart = null;\n    recognition.onresult = null;\n    recognition.onerror = null;\n    recognition.onend = null;\n    recognition.onstart = () => {\n      console.log('Speech recognition started');\n      setIsListening(true);\n    };\n    recognition.onresult = event => {\n      console.log('Speech recognition result event:', event);\n      if (event.results && event.results.length > 0) {\n        const transcript = event.results[0][0].transcript;\n        const confidence = event.results[0][0].confidence;\n        console.log('Transcript:', transcript, 'Confidence:', confidence);\n        setIsListening(false);\n        onResult && onResult(transcript);\n      }\n    };\n    recognition.onerror = event => {\n      console.error('Speech recognition error:', event.error, event);\n      setIsListening(false);\n\n      // If network error, suggest offline mode\n      if (event.error === 'network') {\n        console.log('Network error detected, suggesting offline mode');\n        setOfflineMode(true);\n      }\n      onError && onError(event.error);\n    };\n    recognition.onend = () => {\n      console.log('Speech recognition ended');\n      setIsListening(false);\n    };\n\n    // Small delay to ensure handlers are set\n    setTimeout(() => {\n      try {\n        console.log('Starting recognition...');\n        recognition.start();\n      } catch (error) {\n        console.error('Error starting recognition:', error);\n        setIsListening(false);\n        onError && onError(error.message);\n      }\n    }, 100);\n  };\n  const stopListening = () => {\n    if (recognition) {\n      recognition.stop();\n    }\n    setIsListening(false);\n  };\n  const speak = (text, options = {}) => {\n    if (!synthesis) {\n      console.error('Speech synthesis not supported');\n      return;\n    }\n\n    // Cancel any ongoing speech\n    synthesis.cancel();\n    const utterance = new SpeechSynthesisUtterance(text);\n    utterance.rate = options.rate || 0.8; // Slower for seniors\n    utterance.pitch = options.pitch || 1;\n    utterance.volume = options.volume || 1;\n    if (options.onEnd) {\n      utterance.onend = options.onEnd;\n    }\n    synthesis.speak(utterance);\n  };\n  const stopSpeaking = () => {\n    if (synthesis) {\n      synthesis.cancel();\n    }\n  };\n  const value = {\n    isListening,\n    startListening,\n    stopListening,\n    speak,\n    stopSpeaking,\n    isSupported: !!recognition && !!synthesis\n  };\n  return /*#__PURE__*/_jsxDEV(VoiceContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 179,\n    columnNumber: 5\n  }, this);\n};\n_s2(VoiceProvider, \"YzNXUVEvvPfi6m59Vlc8gYQhPPI=\");\n_c = VoiceProvider;\nvar _c;\n$RefreshReg$(_c, \"VoiceProvider\");","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","jsxDEV","_jsxDEV","VoiceContext","useVoice","_s","context","Error","VoiceProvider","children","_s2","isListening","setIsListening","recognition","setRecognition","synthesis","setSynthesis","offlineMode","setOfflineMode","console","log","window","SpeechRecognition","webkitSpeechRecognition","recognitionInstance","continuous","interimResults","lang","maxAlternatives","serviceURI","undefined","e","error","speechSynthesis","getVoices","length","addEventListener","startListening","onResult","onError","stop","onstart","onresult","onerror","onend","event","results","transcript","confidence","setTimeout","start","message","stopListening","speak","text","options","cancel","utterance","SpeechSynthesisUtterance","rate","pitch","volume","onEnd","stopSpeaking","value","isSupported","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/PROJECT1/frontend/src/context/VoiceContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\r\n\r\nconst VoiceContext = createContext();\r\n\r\nexport const useVoice = () => {\r\n  const context = useContext(VoiceContext);\r\n  if (!context) {\r\n    throw new Error('useVoice must be used within a VoiceProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\nexport const VoiceProvider = ({ children }) => {\r\n  const [isListening, setIsListening] = useState(false);\r\n  const [recognition, setRecognition] = useState(null);\r\n  const [synthesis, setSynthesis] = useState(null);\r\n  const [offlineMode, setOfflineMode] = useState(false);\r\n\r\n  useEffect(() => {\r\n    console.log('Initializing Voice API...');\r\n    \r\n    // Initialize Web Speech API\r\n    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {\r\n      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\r\n      const recognitionInstance = new SpeechRecognition();\r\n      \r\n      recognitionInstance.continuous = false;\r\n      recognitionInstance.interimResults = false;\r\n      recognitionInstance.lang = 'en-US';\r\n      recognitionInstance.maxAlternatives = 1;\r\n      \r\n      // Configure for better offline/network handling\r\n      try {\r\n        // Try to set service URI to local if available (Chrome specific)\r\n        if (recognitionInstance.serviceURI !== undefined) {\r\n          recognitionInstance.serviceURI = '';\r\n        }\r\n      } catch (e) {\r\n        console.log('Cannot configure offline mode, using default');\r\n      }\r\n      \r\n      console.log('Speech Recognition initialized');\r\n      setRecognition(recognitionInstance);\r\n    } else {\r\n      console.error('Speech Recognition not supported in this browser');\r\n    }\r\n\r\n    if ('speechSynthesis' in window) {\r\n      console.log('Speech Synthesis initialized');\r\n      setSynthesis(window.speechSynthesis);\r\n      \r\n      // Preload voices to avoid delays\r\n      if (window.speechSynthesis.getVoices().length === 0) {\r\n        window.speechSynthesis.addEventListener('voiceschanged', () => {\r\n          console.log('Voices loaded:', window.speechSynthesis.getVoices().length);\r\n        });\r\n      }\r\n    } else {\r\n      console.error('Speech Synthesis not supported in this browser');\r\n    }\r\n  }, []);\r\n\r\n  const startListening = (onResult, onError) => {\r\n    console.log('startListening called');\r\n    \r\n    if (!recognition) {\r\n      console.error('Recognition not available');\r\n      onError && onError('Speech recognition not supported');\r\n      return;\r\n    }\r\n\r\n    // Stop any existing recognition first\r\n    try {\r\n      recognition.stop();\r\n    } catch (e) {\r\n      // Ignore errors when stopping\r\n    }\r\n\r\n    console.log('Setting up recognition handlers...');\r\n    setIsListening(true);\r\n    \r\n    // Clear any existing handlers\r\n    recognition.onstart = null;\r\n    recognition.onresult = null;\r\n    recognition.onerror = null;\r\n    recognition.onend = null;\r\n    \r\n    recognition.onstart = () => {\r\n      console.log('Speech recognition started');\r\n      setIsListening(true);\r\n    };\r\n    \r\n    recognition.onresult = (event) => {\r\n      console.log('Speech recognition result event:', event);\r\n      if (event.results && event.results.length > 0) {\r\n        const transcript = event.results[0][0].transcript;\r\n        const confidence = event.results[0][0].confidence;\r\n        console.log('Transcript:', transcript, 'Confidence:', confidence);\r\n        setIsListening(false);\r\n        onResult && onResult(transcript);\r\n      }\r\n    };\r\n\r\n    recognition.onerror = (event) => {\r\n      console.error('Speech recognition error:', event.error, event);\r\n      setIsListening(false);\r\n      \r\n      // If network error, suggest offline mode\r\n      if (event.error === 'network') {\r\n        console.log('Network error detected, suggesting offline mode');\r\n        setOfflineMode(true);\r\n      }\r\n      \r\n      onError && onError(event.error);\r\n    };\r\n\r\n    recognition.onend = () => {\r\n      console.log('Speech recognition ended');\r\n      setIsListening(false);\r\n    };\r\n\r\n    // Small delay to ensure handlers are set\r\n    setTimeout(() => {\r\n      try {\r\n        console.log('Starting recognition...');\r\n        recognition.start();\r\n      } catch (error) {\r\n        console.error('Error starting recognition:', error);\r\n        setIsListening(false);\r\n        onError && onError(error.message);\r\n      }\r\n    }, 100);\r\n  };\r\n\r\n  const stopListening = () => {\r\n    if (recognition) {\r\n      recognition.stop();\r\n    }\r\n    setIsListening(false);\r\n  };\r\n\r\n  const speak = (text, options = {}) => {\r\n    if (!synthesis) {\r\n      console.error('Speech synthesis not supported');\r\n      return;\r\n    }\r\n\r\n    // Cancel any ongoing speech\r\n    synthesis.cancel();\r\n\r\n    const utterance = new SpeechSynthesisUtterance(text);\r\n    utterance.rate = options.rate || 0.8; // Slower for seniors\r\n    utterance.pitch = options.pitch || 1;\r\n    utterance.volume = options.volume || 1;\r\n    \r\n    if (options.onEnd) {\r\n      utterance.onend = options.onEnd;\r\n    }\r\n\r\n    synthesis.speak(utterance);\r\n  };\r\n\r\n  const stopSpeaking = () => {\r\n    if (synthesis) {\r\n      synthesis.cancel();\r\n    }\r\n  };\r\n\r\n  const value = {\r\n    isListening,\r\n    startListening,\r\n    stopListening,\r\n    speak,\r\n    stopSpeaking,\r\n    isSupported: !!recognition && !!synthesis\r\n  };\r\n\r\n  return (\r\n    <VoiceContext.Provider value={value}>\r\n      {children}\r\n    </VoiceContext.Provider>\r\n  );\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}